{"version":3,"sources":["EraserEffectNodeCtrl.ts"],"names":[],"mappings":";;;;AAAA,oBAAoB;AACpB,iFAAiF;AACjF,kFAAkF;AAClF,mBAAmB;AACnB,2FAA2F;AAC3F,4FAA4F;AAC5F,8BAA8B;AAC9B,2FAA2F;AAC3F,4FAA4F;;AAEtF,IAAA,kBAAqC,EAAnC,oBAAO,EAAE,sBAAQ,CAAmB;AAG5C;IAAkD,wCAAY;IAD9D;QAAA,qEAiHC;QArGG,wBAAwB;QACxB,8BAA8B;QAC9B,kBAAY,GAAU;YAClB,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE,CAAC,EAAE,IAAI,EAAE;YACrB,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE,CAAC,EAAE,IAAI,EAAE;YACrB,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE,CAAC,EAAE,IAAI,EAAE;YACrB,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE,CAAC,EAAE,IAAI,EAAE;YACrB,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE,CAAC,EAAE,IAAI,EAAE;YACrB,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE,CAAC,EAAE,IAAI,EAAE;YACrB,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE,CAAC,EAAE,GAAG,EAAE;YACpB,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE,CAAC,EAAE,CAAC,GAAG,EAAE;YACrB,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE;YACtB,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE;YACtB,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE;YACtB,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE;YACtB,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE;YACtB,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE;YACtB,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE;YACtB,EAAE,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE;YACrB,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE;YACpB,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE;YACrB,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE;YACrB,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE;YACrB,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE;YACrB,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE;YACrB,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE;YACrB,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE;YACrB,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE;YACrB,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE;YACrB,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE;YACrB,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE;YACrB,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE;YACrB,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,GAAG,EAAE;YACpB,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,GAAG,EAAE;YACnB,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,IAAI,EAAE;YACpB,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,IAAI,EAAE;YACpB,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,IAAI,EAAE;YACpB,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,IAAI,EAAE;YACpB,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,IAAI,EAAE;YACpB,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,IAAI,EAAE;YACpB,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,IAAI,EAAE;YACpB,EAAE,CAAC,EAAE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","file":"","sourceRoot":"../../../../../assets/script/effct","sourcesContent":["// Learn TypeScript:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/typescript.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/typescript.html\n// Learn Attribute:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class EraserEffectNodeCtrl extends cc.Component {\n\n    @property(cc.Label)\n    rsultLabel: cc.Label;\n\n    @property(cc.Mask)\n    mask: cc.Mask;\n\n    @property(cc.Label)\n    promptLabel: cc.Label;\n\n    // LIFE-CYCLE CALLBACKS:\n    //多边形点数组，可以利用PolygonCollider生成\n    eraserPoints: any[] = [\n        { x: -11.5, y: 74.5 },\n        { x: -30.5, y: 64.5 },\n        { x: -41.5, y: 53.5 },\n        { x: -59.5, y: 44.5 },\n        { x: -67.5, y: 34.5 },\n        { x: -66.5, y: 11.5 },\n        { x: -63.5, y: 5.5 },\n        { x: -55.5, y: -3.5 },\n        { x: -51.5, y: -11.5 },\n        { x: -44.5, y: -36.5 },\n        { x: -38.5, y: -47.5 },\n        { x: -33.5, y: -52.5 },\n        { x: -20.5, y: -58.5 },\n        { x: -17.5, y: -62.5 },\n        { x: -15.5, y: -62.5 },\n        { x: -3.5, y: -73.5 },\n        { x: 5.5, y: -74.5 },\n        { x: 11.5, y: -71.5 },\n        { x: 17.5, y: -65.5 },\n        { x: 22.5, y: -56.5 },\n        { x: 36.5, y: -57.5 },\n        { x: 43.5, y: -55.5 },\n        { x: 51.5, y: -49.5 },\n        { x: 53.5, y: -49.5 },\n        { x: 60.5, y: -40.5 },\n        { x: 59.5, y: -34.5 },\n        { x: 57.5, y: -32.5 },\n        { x: 58.5, y: -16.5 },\n        { x: 60.5, y: -13.5 },\n        { x: 61.5, y: -0.5 },\n        { x: 65.5, y: 7.5 },\n        { x: 67.5, y: 16.5 },\n        { x: 67.5, y: 34.5 },\n        { x: 63.5, y: 42.5 },\n        { x: 59.5, y: 44.5 },\n        { x: 49.5, y: 45.5 },\n        { x: 36.5, y: 50.5 },\n        { x: 35.5, y: 52.5 },\n        { x: 27.5, y: 56.5 },\n        { x: 18.5, y: 66.5 },\n        { x: 16.5, y: 66.5 },\n        { x: 9.5, y: 72.5 },\n        { x: 3.5, y: 74.5 }\n    ];\n    onLoad() {\n        this.node.on(cc.Node.EventType.TOUCH_START, this._onTouchBegin, this);\n        this.node.on(cc.Node.EventType.TOUCH_MOVE, this._onTouchMoved, this);\n        this.node.on(cc.Node.EventType.TOUCH_END, this._onTouchEnd, this);\n        this.node.on(cc.Node.EventType.TOUCH_CANCEL, this._onTouchCancel, this);\n    }\n\n    onDestroy() {\n        this.node.off(cc.Node.EventType.TOUCH_START, this._onTouchBegin, this);\n        this.node.off(cc.Node.EventType.TOUCH_MOVE, this._onTouchMoved, this);\n        this.node.off(cc.Node.EventType.TOUCH_END, this._onTouchEnd, this);\n        this.node.off(cc.Node.EventType.TOUCH_CANCEL, this._onTouchCancel, this);\n    }\n    _onTouchBegin(event: cc.Event.EventTouch) {\n        cc.log('touchBegin');\n        var point = event.touch.getLocation();\n        point = this.node.convertToNodeSpaceAR(point);\n        this._addCircle(point);\n    }\n\n    _onTouchMoved(event: cc.Event.EventTouch) {\n        var point = event.touch.getLocation();\n        point = this.node.convertToNodeSpaceAR(point);\n        this._addCircle(point);\n    }\n\n    _onTouchEnd(event: cc.Event.EventTouch) {\n        var point = event.touch.getLocation();\n        point = this.node.convertToNodeSpaceAR(point);\n        this._addCircle(point);\n    }\n\n    _onTouchCancel(event: cc.Event.EventTouch) {\n\n    }\n    _addCircle(point) {\n        var stencil = this.mask._clippingStencil;\n        var color = cc.color(255, 255, 255, 0);\n        let p = this.dealPoints(point);\n        stencil.drawPoly(p, color, 0, color);\n        if (!CC_JSB) {\n            cc.renderer.childrenOrderDirty = true;\n        }\n    }\n\n    dealPoints(point: cc.Vec2): cc.Vec2[] {\n        const curPoints = JSON.parse(JSON.stringify(this.eraserPoints));\n        for (let index = 0; index < curPoints.length; index++) {\n            const element = curPoints[index];\n            curPoints[index].x = curPoints[index].x + point.x;\n            curPoints[index].y = curPoints[index].y + point.y;\n        }\n        return curPoints;\n    }\n}\n\n"]}